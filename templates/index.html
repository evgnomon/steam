{% extends "base.html" %}

{% block title %}Home - Stimulus + Turbo + WebSocket{% endblock %}

{% block content %}
  <h1>Hotwire + WebSocket</h1>

  <div data-controller="hello">
    <div class="status" data-hello-target="status">Connecting...</div>

    <!-- This element subscribes to the "greetings" stream when visible -->
    <!-- When this element is removed from DOM (e.g., navigating away), it auto-unsubscribes -->
    <turbo-subscribe stream="greetings"></turbo-subscribe>

    <div class="input-group">
      <input
        data-hello-target="name"
        type="text"
        placeholder="Enter your name"
        data-action="keydown.enter->hello#greet"
        autofocus
      >
      <button data-action="click->hello#greet">Greet</button>
    </div>

    <h2>Greetings</h2>
    <ul id="greetings">
      {% for greeting in greetings %}
      <li>{{ greeting }}</li>
      {% endfor %}
    </ul>
  </div>
{% endblock %}

{% block scripts %}
  <script type="module" src="/static/js/turbo-stream-source.js"></script>
  <script type="module" src="/static/js/controllers/hello_controller.js"></script>
{% endblock %}
